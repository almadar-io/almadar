{
  "name": "effects-test",
  "version": "1.0.0",
  "description": "Test: Effect execution (render_ui, set, increment, persist)",
  "orbitals": [
    {
      "name": "CounterManager",
      "entity": {
        "name": "Counter",
        "persistence": "runtime",
        "fields": [
          { "name": "id", "type": "string", "required": true },
          { "name": "value", "type": "number", "default": 0 },
          { "name": "lastUpdated", "type": "timestamp" }
        ]
      },
      "traits": [
        {
          "name": "CounterActions",
          "linkedEntity": "Counter",
          "category": "interaction",
          "stateMachine": {
            "states": [
              { "name": "idle", "isInitial": true },
              { "name": "updated" }
            ],
            "events": [
              { "key": "INIT", "name": "Initialize" },
              { "key": "INCREMENT", "name": "Increment" },
              { "key": "DECREMENT", "name": "Decrement" },
              { "key": "RESET", "name": "Reset" },
              { "key": "SET_VALUE", "name": "Set Value", "payload": [
                { "name": "value", "type": "number", "required": true }
              ]}
            ],
            "transitions": [
              {
                "from": "idle",
                "event": "INIT",
                "to": "idle",
                "effects": [
                  ["render-ui", "main", {
                    "type": "stats",
                    "props": {
                      "title": "Counter Value",
                      "value": "@entity.value",
                      "actions": [
                        { "event": "INCREMENT", "label": "+" },
                        { "event": "DECREMENT", "label": "-" },
                        { "event": "RESET", "label": "Reset" }
                      ]
                    }
                  }]
                ]
              },
              {
                "from": "idle",
                "event": "INCREMENT",
                "to": "updated",
                "effects": [
                  ["increment", "@entity.value", 1],
                  ["set", "@entity.lastUpdated", "@now"]
                ]
              },
              {
                "from": "idle",
                "event": "DECREMENT",
                "to": "updated",
                "effects": [
                  ["decrement", "@entity.value", 1],
                  ["set", "@entity.lastUpdated", "@now"]
                ]
              },
              {
                "from": "idle",
                "event": "RESET",
                "to": "idle",
                "effects": [
                  ["set", "@entity.value", 0],
                  ["set", "@entity.lastUpdated", "@now"]
                ]
              },
              {
                "from": "idle",
                "event": "SET_VALUE",
                "to": "updated",
                "effects": [
                  ["set", "@entity.value", "@payload.value"],
                  ["set", "@entity.lastUpdated", "@now"]
                ]
              },
              {
                "from": "updated",
                "event": "INCREMENT",
                "to": "updated",
                "effects": [
                  ["increment", "@entity.value", 1]
                ]
              },
              {
                "from": "updated",
                "event": "DECREMENT",
                "to": "updated",
                "effects": [
                  ["decrement", "@entity.value", 1]
                ]
              },
              {
                "from": "updated",
                "event": "RESET",
                "to": "idle",
                "effects": [
                  ["set", "@entity.value", 0]
                ]
              }
            ]
          }
        }
      ],
      "pages": [
        {
          "name": "CounterPage",
          "path": "/counter",
          "traits": [
            { "ref": "CounterActions", "linkedEntity": "Counter" }
          ]
        }
      ]
    }
  ]
}
